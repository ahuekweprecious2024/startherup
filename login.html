<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StartHerUp - Login</title>
    <meta
      name="description"
      content="Login to StartHerUp - Funding platform for women entrepreneurs"
    />
    <meta name="theme-color" content="#2ecc71" />

    <!-- PWA support -->
    <link rel="manifest" href="manifest.json" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="StartHerUp" />
    <link rel="apple-touch-icon" href="https://media.istockphoto.com/id/1423550966/vector/profit-rounded-lines-icon.jpg?s=612x612&w=0&k=20&c=_KFEK2PUIlquKGVUYQ18I2rO6xQ3ieFDEx-xHpXRLTI=" />

    <!-- Fonts and icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --primary-green: #2ecc71;
        --dark-green: #27ae60;
        --light-green: #e8f8f2;
        --white: #ffffff;
        --light-gray: #f9f9f9;
        --dark-gray: #333333;
        --transition: all 0.3s ease;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", Arial, sans-serif;
      }

      body {
        color: var(--dark-gray);
        background-color: var(--light-green);
        font-size: 16px;
        line-height: 1.6;
        overflow-x: hidden;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .container {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* Header Styles */
      header {
        background-color: var(--white);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        position: fixed;
        width: 100%;
        z-index: 1000;
      }

      .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 0;
      }

      .logo {
        display: flex;
        align-items: center;
        text-decoration: none;
      }

      .logo h1 {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--primary-green);
      }

      .logo span {
        color: var(--dark-gray);
      }

      .nav-links {
        display: flex;
        gap: 30px;
        list-style: none;
      }

      .nav-links a {
        text-decoration: none;
        color: var(--dark-gray);
        font-weight: 500;
        transition: var(--transition);
      }

      .nav-links a:hover {
        color: var(--primary-green);
      }

      .mobile-menu-btn {
        display: none;
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1.5rem;
        color: var(--dark-gray);
      }

      /* Login Form */
      .login-section {
        flex: 1;
        padding: 140px 0 80px;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .login-container {
        width: 100%;
        max-width: 450px;
        margin: 0 auto;
        background-color: var(--white);
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        position: relative;
      }

      .login-header {
        padding: 30px;
        background: linear-gradient(
          135deg,
          var(--primary-green),
          var(--dark-green)
        );
        color: var(--white);
        text-align: center;
      }

      .login-header h2 {
        font-size: 2.2rem;
        margin-bottom: 10px;
      }

      .login-header p {
        opacity: 0.9;
      }

      .login-form {
        padding: 40px;
      }

      .form-group {
        margin-bottom: 25px;
        position: relative;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: var(--dark-gray);
      }

      .form-control {
        width: 100%;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 16px;
        transition: var(--transition);
      }

      .form-control:focus {
        border-color: var(--primary-green);
        outline: none;
        box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.2);
      }

      .form-group i {
        position: absolute;
        right: 15px;
        top: 48px;
        color: #999;
        cursor: pointer;
      }

      .login-btn {
        width: 100%;
        padding: 15px;
        border: none;
        border-radius: 8px;
        background-color: var(--primary-green);
        color: var(--white);
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        margin-bottom: 20px;
      }

      .login-btn:hover {
        background-color: var(--dark-green);
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(46, 204, 113, 0.3);
      }

      .login-btn:active {
        transform: translateY(-1px);
      }

      .error-message {
        color: #e74c3c;
        font-size: 14px;
        margin-top: 5px;
        display: none;
      }

      .forgot-password {
        text-align: right;
        margin-bottom: 20px;
      }

      .forgot-password a {
        color: var(--primary-green);
        text-decoration: none;
        font-size: 14px;
        transition: var(--transition);
      }

      .forgot-password a:hover {
        color: var(--dark-green);
        text-decoration: underline;
      }

      .register-link {
        text-align: center;
        margin-top: 20px;
      }

      .register-link a {
        color: var(--primary-green);
        text-decoration: none;
        font-weight: 500;
        transition: var(--transition);
      }

      .register-link a:hover {
        color: var(--dark-green);
        text-decoration: underline;
      }

      .divider {
        display: flex;
        align-items: center;
        margin: 25px 0;
        color: #999;
        font-size: 14px;
      }

      .divider::before,
      .divider::after {
        content: "";
        flex: 1;
        border-bottom: 1px solid #ddd;
      }

      .divider::before {
        margin-right: 15px;
      }

      .divider::after {
        margin-left: 15px;
      }

      .social-login {
        display: flex;
        justify-content: center;
        gap: 15px;
      }

      .social-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 12px 20px;
        border-radius: 8px;
        border: 1px solid #ddd;
        background-color: var(--white);
        font-weight: 500;
        cursor: pointer;
        transition: var(--transition);
        flex: 1;
      }

      .social-btn i {
        margin-right: 10px;
        font-size: 18px;
      }

      .social-btn.google i {
        color: #db4437;
      }

      .social-btn.facebook i {
        color: #4267b2;
      }

      .social-btn:hover {
        background-color: var(--light-gray);
        transform: translateY(-2px);
      }

      /* App download banner */
      .app-banner {
        display: none;
        background: linear-gradient(135deg, #27ae60, #2ecc71);
        color: white;
        padding: 15px;
        text-align: center;
        position: fixed;
        bottom: 0;
        width: 100%;
        z-index: 999;
      }

      .app-banner p {
        margin: 0 0 10px;
      }

      .app-banner .close-banner {
        position: absolute;
        top: 10px;
        right: 10px;
        background: none;
        border: none;
        color: white;
        font-size: 16px;
        cursor: pointer;
      }

      .install-btn {
        display: inline-block;
        background-color: white;
        color: var(--primary-green);
        font-weight: 600;
        padding: 8px 20px;
        border-radius: 20px;
        text-decoration: none;
        margin-top: 5px;
        transition: var(--transition);
      }

      .install-btn:hover {
        background-color: var(--light-green);
      }

      /* Loading spinner */
      .spinner-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(255, 255, 255, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        display: none;
      }

      .spinner {
        width: 50px;
        height: 50px;
        border: 5px solid #f3f3f3;
        border-top: 5px solid var(--primary-green);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Footer */
      footer {
        background-color: var(--dark-gray);
        color: var(--white);
        padding: 30px 0;
      }

      .copyright {
        text-align: center;
        color: #999;
        font-size: 0.9rem;
      }

      /* Responsive Styles */
      @media (max-width: 768px) {
        .navbar {
          padding: this.value;
        }

        .nav-links {
          position: fixed;
          top: 80px;
          right: -100%;
          flex-direction: column;
          gap: 0;
          background-color: var(--white);
          width: 300px;
          height: calc(100vh - 80px);
          padding: 40px 0;
          box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
          transition: 0.5s;
        }

        .nav-links.active {
          right: 0;
        }

        .nav-links a {
          display: block;
          padding: 15px 30px;
          border-bottom: 1px solid #eee;
        }

        .mobile-menu-btn {
          display: block;
        }

        .login-form {
          padding: 20px;
        }

        .social-login {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <!-- Loading Spinner -->
    <div class="spinner-overlay" id="spinner">
      <div class="spinner"></div>
    </div>

    <!-- PWA Installation Banner -->
    <div class="app-banner" id="appBanner">
      <button class="close-banner" id="closeBanner">×</button>
      <p>Get the StartHerUp app for a better experience!</p>
      <button class="install-btn" id="installBtn">Install App</button>
    </div>

    <!-- Header -->
    <header>
      <div class="container">
        <nav class="navbar">
          <a href="index.html" class="logo">
            <h1>Start<span>Her</span>Up</h1>
          </a>
          <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="index.html#features">Features</a></li>
            <li><a href="index.html#how-it-works">How It Works</a></li>
            <li><a href="index.html#testimonials">Success Stories</a></li>
            <li><a href="index.html#contact">Contact</a></li>
          </ul>
          <button class="mobile-menu-btn">
            <i class="fas fa-bars"></i>
          </button>
        </nav>
      </div>
    </header>

    <!-- Login Section -->
    <section class="login-section">
      <div class="container">
        <div class="login-container">
          <div class="login-header">
            <h2>Welcome Back</h2>
            <p>Log in to access your entrepreneur dashboard</p>
          </div>
          <div class="login-form">
            <form id="loginForm">
              <div class="form-group">
                <label for="email">Email Address</label>
                <input
                  type="email"
                  id="email"
                  class="form-control"
                  placeholder="Enter your email address"
                  required
                />
                <div class="error-message" id="emailError">
                  Please enter a valid email address
                </div>
              </div>

              <div class="form-group">
                <label for="password">Password</label>
                <input
                  type="password"
                  id="password"
                  class="form-control"
                  placeholder="Enter your password"
                  required
                />
                <i class="far fa-eye" id="togglePassword"></i>
                <div class="error-message" id="passwordError">
                  Please enter your password
                </div>
              </div>

              <div class="forgot-password">
                <a href="#">Forgot Password?</a>
              </div>

              <button type="submit" class="login-btn">Log in</button>

              <div class="divider">OR</div>

              <div class="social-login">
                <button type="button" class="social-btn google">
                  <i class="fab fa-google"></i> Google
                </button>
                <button type="button" class="social-btn facebook">
                  <i class="fab fa-facebook-f"></i> Facebook
                </button>
              </div>

              <div class="register-link">
                Don't have an account?
                <a href="registration.html">Register here</a>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="copyright">
          <p>&copy; 2025 StartHerUp. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- Firebase SDK -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-auth-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-database-compat.min.js"></script>

    <!-- JavaScript -->
    <script>
      // Firebase configuration
      const firebaseConfig = {
        // Replace with your Firebase project configuration
        apiKey: "AIzaSyCgOvIkDCcS3DFrt5f6Y7pYmjCoHIfDF9U",
        authDomain: "moniebase-b4b4d.firebaseapp.com",
        projectId: "moniebase-b4b4d",
        storageBucket: "YOUR_STORAGE_BUCKET",
        messagingSenderId: "1009678808253 ",
        appId: "1:1009678808253:android:ff94e94c52bad2db7973d4",
        databaseURL: "https://moniebase-b4b4d-default-rtdb.firebaseio.com/",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

      // Get Firebase services
      const auth = firebase.auth();
      const database = firebase.database();

      // Mobile Menu Toggle
      const mobileMenuBtn = document.querySelector(".mobile-menu-btn");
      const navLinks = document.querySelector(".nav-links");

      mobileMenuBtn.addEventListener("click", () => {
        navLinks.classList.toggle("active");
        mobileMenuBtn.innerHTML = navLinks.classList.contains("active")
          ? '<i class="fas fa-times"></i>'
          : '<i class="fas fa-bars"></i>';
      });

      // Password visibility toggle
      const togglePassword = document.getElementById("togglePassword");
      const passwordInput = document.getElementById("password");

      togglePassword.addEventListener("click", function () {
        const type =
          passwordInput.getAttribute("type") === "password"
            ? "text"
            : "password";
        passwordInput.setAttribute("type", type);

        // Update the eye icon
        this.classList.toggle("fa-eye");
        this.classList.toggle("fa-eye-slash");
      });

      // Form Validation
      const loginForm = document.getElementById("loginForm");
      const spinner = document.getElementById("spinner");

      // Show an error message
      function showError(elementId, message) {
        const errorElement = document.getElementById(elementId);
        errorElement.textContent = message;
        errorElement.style.display = "block";
      }

      // Hide an error message
      function hideError(elementId) {
        document.getElementById(elementId).style.display = "none";
      }

      // Validate form fields
      function validateForm() {
        let isValid = true;

        // Email validation
        const email = document.getElementById("email").value.trim();
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!email || !emailRegex.test(email)) {
          showError("emailError", "Please enter a valid email address");
          isValid = false;
        } else {
          hideError("emailError");
        }

        // Password validation
        const password = document.getElementById("password").value;
        if (!password) {
          showError("passwordError", "Please enter your password");
          isValid = false;
        } else {
          hideError("passwordError");
        }

        return isValid;
      }

      // Handle form submission
      loginForm.addEventListener("submit", function (e) {
        e.preventDefault();

        // Validate form
        if (!validateForm()) {
          return;
        }

        // Show loading spinner
        spinner.style.display = "flex";

        // Get form values
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value;

        // Sign in with email and password
        auth
          .signInWithEmailAndPassword(email, password)
          .then((userCredential) => {
            // User signed in successfully
            const user = userCredential.user;

            // Save email to localStorage
            localStorage.setItem("userEmail", email);

            // Hide loading spinner
            spinner.style.display = "none";

            // Redirect to dashboard
            window.location.href = "dashboard.html";
          })
          .catch((error) => {
            // Handle errors
            spinner.style.display = "none";
            const errorCode = error.code;
            const errorMessage = error.message;

            if (
              errorCode === "auth/user-not-found" ||
              errorCode === "auth/wrong-password"
            ) {
              showError("passwordError", "Invalid email or password");
            } else if (errorCode === "auth/invalid-email") {
              showError("emailError", "Invalid email format");
            } else if (errorCode === "auth/too-many-requests") {
              showError(
                "passwordError",
                "Too many login attempts. Please try again later."
              );
            } else {
              showError("passwordError", errorMessage);
            }

            console.error("Login error:", error);
          });
      });

      // Google Sign In
      const googleBtn = document.querySelector(".social-btn.google");
      googleBtn.addEventListener("click", function () {
        const provider = new firebase.auth.GoogleAuthProvider();

        spinner.style.display = "flex";

        auth
          .signInWithPopup(provider)
          .then((result) => {
            // Google sign in successful
            const user = result.user;
            localStorage.setItem("userEmail", user.email);

            // Check if user exists in database
            const userEmail = user.email.replace(/\./g, ",");
            database
              .ref("Startherup/" + userEmail)
              .once("value")
              .then((snapshot) => {
                if (snapshot.exists()) {
                  // Existing user, redirect to dashboard
                  window.location.href = "dashboard.html";
                } else {
                  // New user, redirect to registration to complete profile
                  window.location.href = "registration.html";
                }
              });
          })
          .catch((error) => {
            spinner.style.display = "none";
            console.error("Google sign in error:", error);
            alert("Google sign in failed: " + error.message);
          });
      });

      // Facebook Sign In
      const facebookBtn = document.querySelector(".social-btn.facebook");
      facebookBtn.addEventListener("click", function () {
        const provider = new firebase.auth.FacebookAuthProvider();

        spinner.style.display = "flex";

        auth
          .signInWithPopup(provider)
          .then((result) => {
            // Facebook sign in successful
            const user = result.user;
            localStorage.setItem("userEmail", user.email);

            // Check if user exists in database
            const userEmail = user.email.replace(/\./g, ",");
            database
              .ref("Startherup/" + userEmail)
              .once("value")
              .then((snapshot) => {
                if (snapshot.exists()) {
                  // Existing user, redirect to dashboard
                  window.location.href = "dashboard.html";
                } else {
                  // New user, redirect to registration to complete profile
                  window.location.href = "registration.html";
                }
              });
          })
          .catch((error) => {
            spinner.style.display = "none";
            console.error("Facebook sign in error:", error);
            alert("Facebook sign in failed: " + error.message);
          });
      });

      // PWA Installation Logic
      let deferredPrompt;
      const appBanner = document.getElementById("appBanner");
      const installBtn = document.getElementById("installBtn");
      const closeBanner = document.getElementById("closeBanner");

      // Check if app is already installed
      if (
        window.matchMedia("(display-mode: standalone)").matches ||
        window.navigator.standalone === true
      ) {
        // App is already installed, don't show banner
      } else {
        // Listen for beforeinstallprompt event
        window.addEventListener("beforeinstallprompt", (e) => {
          // Prevent Chrome 67 and earlier from automatically showing the prompt
          e.preventDefault();

          // Stash the event so it can be triggered later
          deferredPrompt = e;

          // Show the app install banner
          appBanner.style.display = "block";
        });
      }

      // Install button click handler
      installBtn.addEventListener("click", async () => {
        if (!deferredPrompt) {
          alert(
            "The app cannot be installed at this moment. Please try again later."
          );
          return;
        }

        // Show the install prompt
        deferredPrompt.prompt();

        // Wait for the user to respond to the prompt
        const { outcome } = await deferredPrompt.userChoice;

        // Reset the deferred prompt variable
        deferredPrompt = null;

        // Hide the app banner
        appBanner.style.display = "none";
      });

      // Close banner button
      closeBanner.addEventListener("click", () => {
        appBanner.style.display = "none";
      });
    </script>

    <!-- Service Worker Registration for PWA -->
    <script>
      // Check if service worker is supported
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("/service-worker.js")
            .then((registration) => {
              console.log(
                "ServiceWorker registration successful with scope: ",
                registration.scope
              );
            })
            .catch((error) => {
              console.log("ServiceWorker registration failed: ", error);
            });
        });
      }
    </script>
  </body>
</html>
